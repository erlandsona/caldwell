name: caldwell
version: '0.0.1'
category: Web
author: Austin Erlandson
maintainer: austin@erlandson.com
copyright: 2017 Austin Erlandson
license: MIT
github: erlandsona/caldwell-api
extra-source-files:
  - README.md

dependencies:
  - base >=4.7 && <5

  - aeson
  - bytestring
  - elm-export
  - elm-export-persistent
  - monad-logger
  - mtl
  - persistent
  - persistent-postgresql
  - persistent-template
  - safe
  - servant-docs
  - servant-generic
  - servant-server
  - text
  - time
  - transformers
  - turtle
  - wai
  - wai-cors
  - wai-extra
  - warp

default-extensions:
  - OverloadedStrings

library:
  source-dirs: app/Shared
  when:
    - condition: (flag(dev)) || (flag(library-only))
      then:
        ghc-options:
        - -Wall
        - -Werror
        - -fwarn-tabs
        - -ddump-deriv
        - -ddump-splices
        - -fno-warn-orphans
        - -O0
        cpp-options: -DDEVELOPMENT
      else:
        ghc-options:
        - -Wall
        - -fwarn-tabs
        - -Werror
        - -O2

executables:
  caldwell:
    main: Main.hs
    source-dirs: app/Server
    ghc-options:
      - -Wall
      - -Werror
      - -threaded
      - -rtsopts
      - -with-rtsopts=-N
    dependencies:
      - caldwell
    when:
      - condition: flag(library-only)
        buildable: false
  seed:
    main: Seeds.hs
    source-dirs: db
    ghc-options:
      - -threaded
      - -rtsopts
      - -with-rtsopts=-N
    dependencies:
      - caldwell
    when:
      - condition: flag(library-only)
        buildable: false

tests:
  caldwell-test:
    main: Spec.hs
    source-dirs: test
    ghc-options:
      - -threaded
      - -rtsopts
      - -with-rtsopts=-N
    dependencies:
      - caldwell
      - hspec
      - text
      - neat-interpolation

# Define flags used by "yesod devel" to make compilation faster
flags:
  library-only:
    description: Build for use with "yesod devel"
    manual: false
    default: false
  dev:
    description: Turn on development settings, like auto-reload templates.
    manual: false
    default: false
